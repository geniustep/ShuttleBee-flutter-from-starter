# ๐ ShuttleBee - ูุธุงู ุงูููู ุงููุฏุฑุณู ุงูุฐูู

ุชุทุจูู Flutter ูุชุชุจุน ุญุงููุงุช ุงููุฏุงุฑุณ ูุน ุฏุนู ูุงูู ููุนูู ุจุฏูู ุงุชุตุงู.

## โจ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ (v2.1.1)

- โ **ุงูุชุญูู ูู ุตุญุฉ ุงูุชููู** - ุงูุชุฃูุฏ ูู ุฃู JWT ูุญุชูู ุนูู ุจูุงูุงุช tenant ุงููุทููุจุฉ
- โ **ุญุงูุฉ ุงูุชููู ุบูุฑ ุงูุตุงูุญ** - ุญุงูุฉ ุฌุฏูุฏุฉ `TokenState.invalidToken`
- โ **ุชุณุฌูู ุฎุฑูุฌ ุชููุงุฆู** - ูุณุญ ุงูุฌูุณุฉ ุนูุฏ ุงูุชุดุงู ุชููู ุบูุฑ ุตุงูุญ
- โ **ูุนุงูุฌุฉ ุฎุทุฃ Odoo credentials** - ุงุณุชุซูุงุก ูุญุฏุฏ ููุชูููุงุช ุงููุงูุตุฉ
- โ **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ** - ุชุฑุฌูุฉ ุนุฑุจูุฉ ูุฌููุน ุฃุฎุทุงุก ุงููุตุงุฏูุฉ

## ๐ฆ v2.1.0 

- โ **ุฅุฏุงุฑุฉ ุฐููุฉ ููุฌูุณุงุช** - ุชุฌุฏูุฏ ุชููุงุฆู ูุจู ุงูุชูุงุก ุงูุตูุงุญูุฉ
- โ **ุงูุนูู ุจุฏูู ุงุชุตุงู** - ุงุณุชูุฑ ูู ุงูุนูู ุญุชู ูุน ุงููุทุงุน ุงูุฅูุชุฑูุช
- โ **ุญุงูุงุช ุงููุตุงุฏูุฉ ุงููุชูุฏูุฉ** - ุชุชุจุน ุฏููู ูุญุงูุฉ ุงูุฌูุณุฉ
- โ **ุดุงุดุฉ ุจุฏุงูุฉ ุฐููุฉ** - ุชุชุนุงูู ูุน ุฌููุน ุณููุงุฑูููุงุช ุงููุตุงุฏูุฉ
- โ **ุญูุงูุฉ ุงููุณุงุฑุงุช ููุฃูููุงูู** - ุงูุณูุงุญ ุจุงููุตูู ุจูุงุกู ุนูู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ

## โ๏ธ ุฅุนุฏุงุฏ ูุทููุจ

ูุจู ุชุดุบูู ุงูุชุทุจููุ **ูุฌุจ** ุฅุนุฏุงุฏ Mapbox:

**๐ ุฑุงุฌุน [MAPBOX_SETUP.md](MAPBOX_SETUP.md) ููุชุนูููุงุช ุงูููุตูุฉ**

**ุฅุนุฏุงุฏ ุณุฑูุน:**
1. ุงุญุตู ุนูู token ูุฌุงูู ูู: https://account.mapbox.com/access-tokens/
2. ุนุฏูู ููู `android/app/src/main/res/values/strings.xml`
3. ุงุณุชุจุฏู `YOUR_MAPBOX_ACCESS_TOKEN_HERE` ุจุงููtoken ุงูุฎุงุต ุจู

## ๐ฑ ุงูููุฒุงุช

### ๐บ๏ธ ุงูุชุชุจุน ูุงูุฎุฑุงุฆุท
- **ุชุชุจุน GPS ูุจุงุดุฑ** - ูููุน ุญู ูุน Mapbox
- **ุฅุฏุงุฑุฉ ุงูุฑุญูุงุช** - ุฅุฏุงุฑุฉ ุงููุณุงุฑุงุช ูุงูุฑุญูุงุช
- **ุชุชุจุน ุงูุฑูุงุจ** - ุชุชุจุน ุงูุทูุงุจ ูู ูู ูุญุทุฉ
- **Geofencing** - ุฅุดุนุงุฑุงุช ุชููุงุฆูุฉ ุนูุฏ ุงูุงูุชุฑุงุจ ูู ุงููุญุทุงุช

### ๐ ุงููุตุงุฏูุฉ ุงูุฐููุฉ (v2.1.1)
- **ุงูุชุญูู ูู ุตุญุฉ ุงูุชููู** - ุงูุชุฃูุฏ ูู ูุฌูุฏ `user_type: "tenant"` ู `tenant_id`
- **ุชุณุฌูู ุฎุฑูุฌ ุชููุงุฆู** - ุนูุฏ ุงูุชุดุงู ุชููู ุบูุฑ ุตุงูุญ
- **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ** - "ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ. ูุฑุฌู ุชุณุฌูู ุงูุฎุฑูุฌ ูุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู"
- **ุชุฌุฏูุฏ ุชููุงุฆู ููุชููู** - ูุจู ุงูุชูุงุก ุงูุตูุงุญูุฉ
- **ุงูุนูู ุจุฏูู ุงุชุตุงู** - ุงุณุชูุฑ ูู ุงูุนูู ูุน ุงูุจูุงูุงุช ุงููุฎุฒูุฉ
- **ุญุงูุงุช ุงูุฌูุณุฉ** - `valid`, `needsRefresh`, `expired`, `none`, `invalidToken`
- **ุชูุฌูู ุญุณุจ ุงูุฏูุฑ** - ุณุงุฆูุ ูุดุบูุ ูุฏูุฑุ ุฑุงูุจ

### ๐ฅ ุงูุฃุฏูุงุฑ ุงููุฏุนููุฉ
- **๐ ุงูุณุงุฆู** - ุฅุฏุงุฑุฉ ุงูุฑุญูุงุช ูุงูุชุชุจุน ุงููุจุงุดุฑ
- **๐ ุงููุดุบู** - ุฅุฏุงุฑุฉ ุงูุญุงููุงุช ูุงูุณุงุฆููู
- **๐ ุงููุฏูุฑ** - ููุญุฉ ุชุญูู ุดุงููุฉ ูุชูุงุฑูุฑ
- **๐ ุงูุฑุงูุจ** - ุชุชุจุน ุงูุญุงููุฉ ูุงูุฅุดุนุงุฑุงุช

### ๐ ุฏุนู ุงูุฃูููุงูู
- **ุงูุนูู ุจุฏูู ุงุชุตุงู** - ุญุชู ูุน ุงููุทุงุน ุงูุฅูุชุฑูุช
- **ูุฒุงููุฉ ุฐููุฉ** - ูุฒุงููุฉ ุงูุชุบููุฑุงุช ุนูุฏ ุนูุฏุฉ ุงูุงุชุตุงู
- **ุจูุงูุงุช ูุฎุฒูุฉ** - ุงููุตูู ููุจูุงูุงุช ุงููุญููุธุฉ ูุญููุงู

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ุงููุชุทูุจุงุช
- Flutter SDK (3.0 ุฃู ุฃุนูู)
- Android Studio / Xcode
- ุญุณุงุจ Mapbox (ูุฌุงูู)
- ุฎุงุฏู Odoo ูุน BridgeCore

### ุงูุชุซุจูุช

1. **ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน**
   ```bash
   git clone <repository-url>
   cd ShuttleBee-flutter-from-starter
   ```

2. **ุชุซุจูุช ุงูุญุฒู**
   ```bash
   flutter pub get
   ```

3. **ุฅุนุฏุงุฏ Mapbox** (ูุทููุจ)
   - ุฑุงุฌุน [MAPBOX_SETUP.md](MAPBOX_SETUP.md)

4. **ุฅุนุฏุงุฏ ุงูุจูุฆุฉ**
   ```bash
   cp .env.example .env
   # ุนุฏูู .env ุจุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู
   ```

5. **ุชุดุบูู ุงูุชุทุจูู**
   ```bash
   flutter run
   ```

## ๐ ูููู ุงููุดุฑูุน

```
lib/
โโโ main.dart                 # ููุทุฉ ุงูุฏุฎูู
โโโ app.dart                  # ุงููWidget ุงูุฑุฆูุณู
โโโ bootstrap/                # ุชููุฆุฉ ุงูุชุทุจูู
โโโ core/
โ   โโโ bridgecore_integration/  # ุชูุงูู BridgeCore
โ   โโโ enums/                   # ุงูุฃุฏูุงุฑ ูุญุงูุงุช ุงูุฑุญูุงุช
โ   โโโ routing/                 # ุงูุชูุฌูู ุญุณุจ ุงูุฏูุฑ
โ   โโโ network/                 # ุทุจูุฉ ุงูุดุจูุฉ
โ   โโโ services/                # ุงูุฎุฏูุงุช ุงููุญููุฉ
โโโ features/
โ   โโโ splash/              # ุดุงุดุฉ ุงูุจุฏุงูุฉ ุงูุฐููุฉ
โ   โโโ auth/                # ุงููุตุงุฏูุฉ ูุน TokenState
โ   โโโ driver/              # ูุงุฌูุฉ ุงูุณุงุฆู
โ   โโโ dispatcher/          # ูุงุฌูุฉ ุงููุดุบู
โ   โโโ manager/             # ูุงุฌูุฉ ุงููุฏูุฑ
โ   โโโ passenger/           # ูุงุฌูุฉ ุงูุฑุงูุจ
โ   โโโ trips/               # ุฅุฏุงุฑุฉ ุงูุฑุญูุงุช
โโโ l10n/                    # ุงูุชุฑุฌูุฉ (ุนุฑุจู/ุฅูุฌููุฒู)
```

## ๐ง ุงุณุชุฎุฏุงู ุงููุตุงุฏูุฉ ุงูุฐููุฉ

### ุงูุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ

```dart
import 'package:shuttlebee/features/auth/presentation/providers/auth_provider.dart';
import 'package:shuttlebee/features/auth/domain/entities/user.dart';

class MyWidget extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final authState = ref.watch(authStateProvider);
    
    return authState.when(
      data: (auth) {
        switch (auth.tokenState) {
          case TokenState.valid:
            // ุฌูุณุฉ ุตุงูุญุฉ - ุงุฐูุจ ููุตูุญุฉ ุงูุฑุฆูุณูุฉ
            return getHomeForRole(auth.user?.role);
          case TokenState.needsRefresh:
            // ุชุญุชุงุฌ ุชุฌุฏูุฏ - ุงุนุฑุถ ูุน ูุคุดุฑ
            return HomeScreen(showRefreshBanner: auth.isOffline);
          case TokenState.expired:
            // ุงูุชูุช ุงูุตูุงุญูุฉ - ุงุฐูุจ ูุชุณุฌูู ุงูุฏุฎูู
            return LoginScreen(message: 'ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ');
          case TokenState.none:
            // ูุง ุชูุฌุฏ ุฌูุณุฉ
            return LoginScreen();
        }
      },
      loading: () => SplashScreen(),
      error: (e, _) => ErrorScreen(error: e),
    );
  }
}
```

### ุงูุชุนุงูู ูุน ุงูุฃูููุงูู

```dart
// ุงูุชุญูู ูู ุฅููุงููุฉ ุงูุนูู ุฃูููุงูู
final canWorkOffline = ref.read(authStateProvider).asData?.value.canWorkOffline ?? false;

// ุงูุชุญูู ูู ุญุงูุฉ ุงูุงุชุตุงู
final isOffline = !ref.watch(isOnlineProvider);

// ุชุญุฏูุซ ุญุงูุฉ ุงูุดุจูุฉ
ref.read(authStateProvider.notifier).updateNetworkStatus(isOnline);

// ุชุฌุฏูุฏ ูุฏูู ุนูุฏ ุนูุฏุฉ ุงูุงุชุตุงู
if (isOnline && auth.needsTokenRefresh) {
  final success = await ref.read(authStateProvider.notifier).refreshToken();
}
```

### ุงูุชูุฌูู ุญุณุจ ุงูุฏูุฑ

```dart
import 'package:shuttlebee/core/routing/role_routing.dart';

// ุงูุญุตูู ุนูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ ุญุณุจ ุงูุฏูุฑ
final homeRoute = getHomeRouteForRole(user?.role);

// ุงูุฃุฏูุงุฑ ุงููุชุงุญุฉ:
// - UserRole.driver โ DriverHomeScreen
// - UserRole.dispatcher โ DispatcherHomeScreen  
// - UserRole.manager โ ManagerHomeScreen
// - UserRole.passenger โ PassengerHomeScreen
```

## ๐ ุงูุชูุซูู

- **[MAPBOX_SETUP.md](MAPBOX_SETUP.md)** - ุฅุนุฏุงุฏ Mapbox (ูุทููุจ)
- **[MAPS_INTEGRATION_GUIDE.md](MAPS_INTEGRATION_GUIDE.md)** - ููุฒุงุช ุงูุฎุฑุงุฆุท ุงููุชูุฏูุฉ

## ๐๏ธ ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

- **Flutter** - ุฅุทุงุฑ ุงูุนูู
- **Riverpod** - ุฅุฏุงุฑุฉ ุงูุญุงูุฉ
- **Mapbox** - ุงูุฎุฑุงุฆุท ูุงูููุงุญุฉ
- **Hive** - ุงูุชุฎุฒูู ุงููุญูู
- **Geolocator** - ุชุชุจุน GPS
- **BridgeCore SDK v3.1.0** - ุงูุชูุงูู ูุน ุงูุฎุงุฏู

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ "MapboxConfigurationException"
ูุฐุง ูุนูู ุฃูู ูู ุชูุนุฏ Mapbox token ุจุนุฏ. ุฑุงุฌุน [MAPBOX_SETUP.md](MAPBOX_SETUP.md).

### ุงูุฎุฑูุทุฉ ูุง ุชุธูุฑ
1. ุชุญูู ูู ุงุชุตุงู ุงูุฅูุชุฑูุช
2. ุชุฃูุฏ ูู ุตุญุฉ Mapbox token
3. ูููุฐ `flutter clean` ูุฃุนุฏ ุงูุจูุงุก

### ูุดุงูู ุชุณุฌูู ุงูุฏุฎูู
1. ุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฎุงุฏู ูู `.env`
2. ุชุฃูุฏ ูู ุชุดุบูู ุฎุงุฏู BridgeCore
3. ุฑุงุฌุน logs ุงูุชุทุจูู ููุชูุงุตูู

### ุฎุทุฃ "Missing Odoo credentials" (ุฌุฏูุฏ v2.1.1)
ูุฐุง ุงูุฎุทุฃ ูุนูู ุฃู ุงูุชููู ุงููุฎุฒู ูุง ูุญุชูู ุนูู ุจูุงูุงุช tenant ุงููุทููุจุฉ:
1. **ุงูุญู:** ุณุฌู ุฎุฑูุฌ ุซู ุฃุนุฏ ุชุณุฌูู ุงูุฏุฎูู
2. **ุงูุณุจุจ:** ุงูุชููู ูู ูุธุงู ูุฏูู ุฃู ูู endpoint ุฎุงุทุฆ
3. **ุงูุชุทุจูู ูุชุนุงูู ุชููุงุฆูุงู:** ููุชุดู ุงูุชููู ุบูุฑ ุงูุตุงูุญ ููุทูุจ ุฅุนุงุฏุฉ ุชุณุฌูู ุงูุฏุฎูู

### ุงูุนูู ุฃูููุงูู ูุง ูุนูู
1. ุชุฃูุฏ ูู ุชุณุฌูู ุงูุฏุฎูู ูุฑุฉ ูุงุญุฏุฉ ุนูู ุงูุฃูู ูุฃูุช ูุชุตู
2. ุงูุจูุงูุงุช ุชูุฎุฒู ุชููุงุฆูุงู ุจุนุฏ ุฃูู ุชุณุฌูู ุฏุฎูู ูุงุฌุญ
3. ุนูุฏ ุงููุทุงุน ุงูุงุชุตุงูุ ุงูุชุทุจูู ูุณุชุฎุฏู ุงูุจูุงูุงุช ุงููุฎุฒูุฉ

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ุฌุฒุก ูู ูุธุงู BridgeCore Flutter.

---

**ุงูุฅุตุฏุงุฑ:** 2.1.1  
**BridgeCore SDK:** v3.1.1  
**ุขุฎุฑ ุชุญุฏูุซ:** 2025-11-30

**ุตููุน ุจู โค๏ธ ูู ุฃุฌู ููู ูุฏุฑุณู ุฃูุซุฑ ุฃูุงูุงู**
